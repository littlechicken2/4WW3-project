<!DOCTYPE HTML>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>GamerFriend</title>
  <link rel="stylesheet" href="project.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
   integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
   crossorigin=""/>
  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
   integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
   crossorigin=""></script>
  <style>
  #map{
    height: 500px;
    width: 100%;
  }
  </style>
</head>
<img src="10.png" class="bg" alt="bg">
<div id="page-wrap">
  <!-- Navbar -->
  <ul>
    <li><a href="index.html">Home</a></li>
    <li class="lii"><header class="neonText"> GamerFriend - The Ultimate Gameshop Finder</header></li>
    <li class="ri"><button class="button2" onclick="document.getElementById('id01').style.display='block'">Login</button></li>
    <li class="ri"><button class="button2" onclick="document.getElementById('id02').style.display='block'">Submit Location</button></li>
  </ul>

  <div id="id01" class="modal"> <!-- Login Popup -->
    <form class="modal-content animate" action="/action_page.php" method="post">
      <div class="container">
        <label id="uname"><b>Username</b></label>
        <input type="text" placeholder="Enter Username" name="uname" required>
        <label id="psw"><b>Password</b></label>
        <input type="password" placeholder="Enter Password" name="psw" required>
        <button type="submit">Login</button>
        <label>
          <input type="checkbox" checked="checked" name="remember"> Remember me
        </label>
      </div>

      <div class="text" style="background-color:#f1f1f1">
        <button type="button" onclick="document.getElementById('id01').style.display='none'" class="cancelbtn">Cancel</button>
        <span class="psw"> <a href="#">Forgot password?</a></span>
      </div>
    </form>
  </div>

  <div id="id02" class="modal"> <!-- Submit Location Popup -->
    <form class="modal-content animate" action="/action_page.php" method="post">
      <div class="container">
        <p style="font-size:30px">New Location</p>
        <label id="locationname"><b>Location Name</b></label>
        <input type="text" placeholder="Enter location Name" name="locationname" required>
        <label id="coordinate"><b>(Latitude,Longtitude)</b></label>
        <input type="text" placeholder="Enter coordinate eg.(108.232,90.367)" name="coordinate">
        <p>Description</p>
        <textarea name="description" style="width:1000px; height:160px"></textarea>
        <p></p>
        <button>Upload a picture or video</button>
        <p></p>
        <button type="submit">Submit</button>
      </div>
    </form>
  </div>

  <script> // The script control login page
  // Get the login_tab
  var modal = document.getElementById('id01');
  var modal2 = document.getElementById('id02');
  // When the user clicks anywhere outside of the modal, close it
  window.onclick = function(event) {
    if (event.target == modal) {
      modal.style.display = "none";
    }
    else if (event.target == modal2) {
      modal2.style.display = "none";
    }
  }
  </script>

  <p></p> <!-- add this for add spacing -->

  <!-- NO CHANGE ABOVE -->

  <h1 class = "neonText">Search results for: EB GAMES</h1>
  <button class="button1 btn start" type="submit" onclick="local()"><span>Search</span></button>
  <button class="button1 btn start" type="submit" onclick="getLocation()"><span>Search nearby</span></button>
  <div class="row">

    <div class = "column3a">
      <a href="http://3.130.231.165/GAMER/individual_sample.html">
        <div class = "neonbox card">
          <h2 class="neonText">EB games</h2>
          <hr class="neon">
          <img src="r1.jpg" style="width:50%; height:150px; float:left" alt="shopimage">
          <p></p>
          <p class="whitetext">2.2km <b>from you</b></p>
          <p class="whitetext"><b>Address: </b>University Plaza</p>
          <p class="whitetext">101 Osler Dr. Unit 134B</p>
          <p class="whitetext">Dundas, ON L9H 4H4</p>
          <p></p>
          <hr class="neon">
          <img src="r1.jpg" style="width:50%; height:150px; float:left" alt="shopimage">
          <p></p>
          <p class="whitetext">1km <b>from you</b></p>
          <p class="whitetext"><b>Address: </b>Westdale</p>
          <p class="whitetext">878 King Street West</p>
          <p class="whitetext">Hamilton, ON L8S 4S6</p>
          <p></p>
        </div>
      </a>
    </div>

    <div class = "column3b">
      <div class="neonbox card">
        <h2 class="neonText">MAP</h2>
        <hr class="neon">
        <p id="demo"></p>
        <!--<div> that our map will be loaded into -->
        <div id="map"></div>
        <!--<img src="l1.png" class="img" alt="location"> -->
      </div>
    </div>
  </div>

  <script>
    var map = L.map('map').setView([43.263,-79.919], 14);

    // use the OpenStreetMapstiles
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' + '<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>'
    }).addTo(map);
    
    //map.setView([43.263,-79.919], 14);

    L.marker([43.258007, -79.942983])
     .addTo(map)
     .bindPopup("<b><a href='http://www.ebgames.ca'>EB Games</a></b> at University Plaza, 101 Osler Dr. Unit 134B")
     .openPopup();

    L.marker([43.263344, -79.900986])
     .addTo(map)
     .bindPopup("<b><a href='http://www.ebgames.ca'>EB Games</a></b> at Westdale, 878 King Street West")
     .openPopup();

    var x = document.getElementById("demo");

    function getLocation() {
      if (navigator.geolocation) {
        //setTimeout(function(){
          //window.location.href = 'results_sample.html'; // wait for user allow get location  
        //}, 3000)
        navigator.geolocation.getCurrentPosition(showPosition);
      } else { 
        x.innerHTML = "Geolocation is not supported by this browser.";
      }
    }
       
    function showPosition(position) {
      x.innerHTML = "Latitude: " + position.coords.latitude + 
      "<br>Longitude: " + position.coords.longitude;
      localStorage.setItem("latitude",position.coords.latitude);
      localStorage.setItem("longtitude",position.coords.longitude);
      //window.onload = alert(localStorage.getItem("latitude"));
      
      map.panTo([position.coords.latitude, position.coords.longitude], 15);

      L.marker([position.coords.latitude, position.coords.longitude])
       .addTo(map)
       .bindPopup("You are <b>Here</b>")
       .openPopup();
    }


    // create the map and load it into the div with id="mymap"
    /*
    window.onload = alert(localStorage.getItem("latitude"));
    if (localStorage.getItem("latitude") && localStorage.getItem("longtitude")) {
      var map = L.map('map').setView([localStorage.getItem("latitude"),localStorage.getItem("longtitude")], 15);
      L.marker([localStorage.getItem("latitude"),localStorage.getItem("longtitude")])
      .addTo(map)
      .bindPopup("Your Location")
      .openPopup();
    }
    else{
      var map = L.map('map').setView([43.263,-79.919], 15);
      //[43.2602836,-79.9646182] // [43.263,-79.919]
    }
    */

    function local(){

      map.panTo([43.263,-79.919], 14);

      // use the OpenStreetMapstiles
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' + '<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>'
      }).addTo(map);
      
      //map.setView([43.263,-79.919], 14);


      L.marker([43.258007, -79.942983])
       .addTo(map)
       .bindPopup("<b><a href='http://www.ebgames.ca'>EB Games</a></b> at University Plaza, 101 Osler Dr. Unit 134B")
       .openPopup();

      L.marker([43.263344, -79.900986])
       .addTo(map)
       .bindPopup("<b><a href='http://www.ebgames.ca'>EB Games</a></b> at Westdale, 878 King Street West")
       .openPopup();
      
      //localStorage.clear();
    }


    // create a blank pop-up for later use
    var popup = L.popup();
    // display a popup when the user clicks on the map
    function onMapClick(e) {
    popup.setLatLng(e.latlng)
     .setContent("You clicked the map at " + e.latlng.toString())
     .openOn(map);
    }
    map.on('click', onMapClick);

    </script>
  
  <h1></h1>

  <footer style="position:fixed;bottom:0;width:100%;">
    <p>
      &copy; 2021 Franky Jin&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jint8@mcmaster.ca&nbsp;&nbsp;|&nbsp;&nbsp;Andy Ng&nbsp;&nbsp;&nbsp;&nbsp;nga15@mcmaster.ca
    </p>
  </footer>
</div> <!-- background -->
</body>
</html>
